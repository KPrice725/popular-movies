package com.boxnotfound.popularmovies;

import com.boxnotfound.popularmovies.model.Movie;
import com.boxnotfound.popularmovies.model.MovieJSONResult;
import com.google.gson.Gson;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;

import java.util.List;

import androidx.annotation.NonNull;

import static org.hamcrest.CoreMatchers.is;
import static org.hamcrest.CoreMatchers.notNullValue;
import static org.hamcrest.MatcherAssert.assertThat;

public class GetMoviesGsonTest {

    /*
    Test to ensure Gson deserialization of JSON responses for get most popular movies and get top rated movies
    are properly handled
    */

    // Sample response from TMDB's API's call for the first page of popular movies
    private final String SAMPLE_MOST_POPULAR_JSON_RESPONSE = "{\"page\":1,\"total_results\":19806,\"total_pages\":991,\"results\":[{\"vote_count\":3560,\"id\":299534,\"video\":false,\"vote_average\":8.7,\"title\":\"Avengers: Endgame\",\"popularity\":487.806,\"poster_path\":\"\\/or06FN3Dka5tukK1e9sl16pB3iy.jpg\",\"original_language\":\"en\",\"original_title\":\"Avengers: Endgame\",\"genre_ids\":[12,878,28],\"backdrop_path\":\"\\/7RyHsO4yDXtBv1zUU3mTpHeQ0d5.jpg\",\"adult\":false,\"overview\":\"After the devastating events of Avengers: Infinity War, the universe is in ruins due to the efforts of the Mad Titan, Thanos. With the help of remaining allies, the Avengers must assemble once more in order to undo Thanos' actions and restore order to the universe once and for all, no matter what consequences may be in store.\",\"release_date\":\"2019-04-24\"},{\"vote_count\":4510,\"id\":299537,\"video\":false,\"vote_average\":7.1,\"title\":\"Captain Marvel\",\"popularity\":286.596,\"poster_path\":\"\\/AtsgWhDnHTq68L0lLsUrCnM7TjG.jpg\",\"original_language\":\"en\",\"original_title\":\"Captain Marvel\",\"genre_ids\":[28,12,878],\"backdrop_path\":\"\\/w2PMyoyLU22YvrGK3smVM9fW1jj.jpg\",\"adult\":false,\"overview\":\"The story follows Carol Danvers as she becomes one of the universe’s most powerful heroes when Earth is caught in the middle of a galactic war between two alien races. Set in the 1990s, Captain Marvel is an all-new adventure from a previously unseen period in the history of the Marvel Cinematic Universe.\",\"release_date\":\"2019-03-06\"},{\"vote_count\":13182,\"id\":299536,\"video\":false,\"vote_average\":8.3,\"title\":\"Avengers: Infinity War\",\"popularity\":219.745,\"poster_path\":\"\\/7WsyChQLEftFiDOVTGkv3hFpyyt.jpg\",\"original_language\":\"en\",\"original_title\":\"Avengers: Infinity War\",\"genre_ids\":[12,28,14],\"backdrop_path\":\"\\/bOGkgRGdhrBYJSLpXaxhXVstddV.jpg\",\"adult\":false,\"overview\":\"As the Avengers and their allies have continued to protect the world from threats too large for any one hero to handle, a new danger has emerged from the cosmic shadows: Thanos. A despot of intergalactic infamy, his goal is to collect all six Infinity Stones, artifacts of unimaginable power, and use them to inflict his twisted will on all of reality. Everything the Avengers have fought for has led up to this moment - the fate of Earth and existence itself has never been more uncertain.\",\"release_date\":\"2018-04-25\"},{\"vote_count\":280,\"id\":456740,\"video\":false,\"vote_average\":5.2,\"title\":\"Hellboy\",\"popularity\":211.526,\"poster_path\":\"\\/bk8LyaMqUtaQ9hUShuvFznQYQKR.jpg\",\"original_language\":\"en\",\"original_title\":\"Hellboy\",\"genre_ids\":[28,12,14],\"backdrop_path\":\"\\/5BkSkNtfrnTuKOtTaZhl8avn4wU.jpg\",\"adult\":false,\"overview\":\"Hellboy comes to England, where he must defeat Nimue, Merlin's consort and the Blood Queen. But their battle will bring about the end of the world, a fate he desperately tries to turn away.\",\"release_date\":\"2019-04-10\"},{\"vote_count\":716,\"id\":537915,\"video\":false,\"vote_average\":6.2,\"title\":\"After\",\"popularity\":200.263,\"poster_path\":\"\\/u3B2YKUjWABcxXZ6Nm9h10hLUbh.jpg\",\"original_language\":\"en\",\"original_title\":\"After\",\"genre_ids\":[18,10749],\"backdrop_path\":\"\\/8lESY7UGpOsbL2caib9Qe4bOebF.jpg\",\"adult\":false,\"overview\":\"A young woman falls for a guy with a dark secret and the two embark on a rocky relationship.\",\"release_date\":\"2019-04-11\"},{\"vote_count\":361,\"id\":438650,\"video\":false,\"vote_average\":5.3,\"title\":\"Cold Pursuit\",\"popularity\":172.511,\"poster_path\":\"\\/otK0H9H1w3JVGJjad5Kzx3Z9kt2.jpg\",\"original_language\":\"en\",\"original_title\":\"Cold Pursuit\",\"genre_ids\":[28,18,53,80],\"backdrop_path\":\"\\/aiM3XxYE2JvW1vJ4AC6cI1RjAoT.jpg\",\"adult\":false,\"overview\":\"Nels Coxman's quiet life comes crashing down when his beloved son dies under mysterious circumstances. His search for the truth soon becomes a quest for revenge as he seeks coldblooded justice against a drug lord and his inner circle.\",\"release_date\":\"2019-02-07\"},{\"vote_count\":19138,\"id\":24428,\"video\":false,\"vote_average\":7.6,\"title\":\"The Avengers\",\"popularity\":168.079,\"poster_path\":\"\\/cezWGskPY5x7GaglTTRN4Fugfb8.jpg\",\"original_language\":\"en\",\"original_title\":\"The Avengers\",\"genre_ids\":[878,28,12],\"backdrop_path\":\"\\/hbn46fQaRmlpBuUrEiFqv0GDL6Y.jpg\",\"adult\":false,\"overview\":\"When an unexpected enemy emerges and threatens global safety and security, Nick Fury, director of the international peacekeeping agency known as S.H.I.E.L.D., finds himself in need of a team to pull the world back from the brink of disaster. Spanning the globe, a daring recruitment effort begins!\",\"release_date\":\"2012-04-25\"},{\"vote_count\":1346,\"id\":287947,\"video\":false,\"vote_average\":7.2,\"title\":\"Shazam!\",\"popularity\":153.269,\"poster_path\":\"\\/xnopI5Xtky18MPhK40cZAGAOVeV.jpg\",\"original_language\":\"en\",\"original_title\":\"Shazam!\",\"genre_ids\":[35,12,14],\"backdrop_path\":\"\\/bi4jh0Kt0uuZGsGJoUUfqmbrjQg.jpg\",\"adult\":false,\"overview\":\"A boy is given the ability to become an adult superhero in times of need with a single magic word.\",\"release_date\":\"2019-03-23\"},{\"vote_count\":14,\"id\":495925,\"video\":false,\"vote_average\":5.9,\"title\":\"Doraemon the Movie: Nobita's Treasure Island\",\"popularity\":143.822,\"poster_path\":\"\\/cmJ71gdZxCqkMUvGwWgSg3MK7pC.jpg\",\"original_language\":\"ja\",\"original_title\":\"映画ドラえもん のび太の宝島\",\"genre_ids\":[16],\"backdrop_path\":\"\\/8OamoIWfC9zmhwhh1PPaBcDoQaH.jpg\",\"adult\":false,\"overview\":\"The story is based on Robert Louis Stevenson's Treasure Island novel.\",\"release_date\":\"2018-03-03\"},{\"vote_count\":2570,\"id\":450465,\"video\":false,\"vote_average\":6.5,\"title\":\"Glass\",\"popularity\":121.009,\"poster_path\":\"\\/svIDTNUoajS8dLEo7EosxvyAsgJ.jpg\",\"original_language\":\"en\",\"original_title\":\"Glass\",\"genre_ids\":[53,9648,18,14,878],\"backdrop_path\":\"\\/lvjscO8wmpEbIfOEZi92Je8Ktlg.jpg\",\"adult\":false,\"overview\":\"In a series of escalating encounters, security guard David Dunn uses his supernatural abilities to track Kevin Wendell Crumb, a disturbed man who has twenty-four personalities. Meanwhile, the shadowy presence of Elijah Price emerges as an orchestrator who holds secrets critical to both men.\",\"release_date\":\"2019-01-16\"},{\"vote_count\":11849,\"id\":284054,\"video\":false,\"vote_average\":7.4,\"title\":\"Black Panther\",\"popularity\":109.074,\"poster_path\":\"\\/uxzzxijgPIY7slzFvMotPv8wjKA.jpg\",\"original_language\":\"en\",\"original_title\":\"Black Panther\",\"genre_ids\":[28,12,14,878],\"backdrop_path\":\"\\/6ELJEzQJ3Y45HczvreC3dg0GV5R.jpg\",\"adult\":false,\"overview\":\"King T'Challa returns home from America to the reclusive, technologically advanced African nation of Wakanda to serve as his country's new leader. However, T'Challa soon finds that he is challenged for the throne by factions within his own country as well as without. Using powers reserved to Wakandan kings, T'Challa assumes the Black Panther mantel to join with girlfriend Nakia, the queen-mother, his princess-kid sister, members of the Dora Milaje (the Wakandan 'special forces') and an American secret agent, to prevent Wakanda from being dragged into a world war.\",\"release_date\":\"2018-02-13\"},{\"vote_count\":13000,\"id\":99861,\"video\":false,\"vote_average\":7.3,\"title\":\"Avengers: Age of Ultron\",\"popularity\":108.673,\"poster_path\":\"\\/t90Y3G8UGQp0f0DrP60wRu9gfrH.jpg\",\"original_language\":\"en\",\"original_title\":\"Avengers: Age of Ultron\",\"genre_ids\":[28,12,878],\"backdrop_path\":\"\\/rFtsE7Lhlc2jRWF7SRAU0fvrveQ.jpg\",\"adult\":false,\"overview\":\"When Tony Stark tries to jumpstart a dormant peacekeeping program, things go awry and Earth’s Mightiest Heroes are put to the ultimate test as the fate of the planet hangs in the balance. As the villainous Ultron emerges, it is up to The Avengers to stop him from enacting his terrible plans, and soon uneasy alliances and unexpected action pave the way for an epic and unique global adventure.\",\"release_date\":\"2015-04-22\"},{\"vote_count\":6,\"id\":447404,\"video\":false,\"vote_average\":5,\"title\":\"POKÉMON Detective Pikachu\",\"popularity\":103.526,\"poster_path\":\"\\/wgQ7APnFpf1TuviKHXeEe3KnsTV.jpg\",\"original_language\":\"en\",\"original_title\":\"POKÉMON Detective Pikachu\",\"genre_ids\":[9648,10751,80,14],\"backdrop_path\":\"\\/yXybBEC45p84D0Ky7GmQQYrclVr.jpg\",\"adult\":false,\"overview\":\"In a world where people collect pocket-size monsters (pokemon) to do battle, a boy comes across an intelligent monster who seeks to be a detective.\",\"release_date\":\"2019-05-03\"},{\"vote_count\":11,\"id\":576393,\"video\":false,\"vote_average\":6,\"title\":\"Fall in Love at First Kiss\",\"popularity\":98.181,\"poster_path\":\"\\/wtaSH8MfJSCEIrrEX9SQuHdU5sl.jpg\",\"original_language\":\"zh\",\"original_title\":\"一吻定情\",\"genre_ids\":[10749,35],\"backdrop_path\":\"\\/yY7kr7Rgvo8W0Kr3U0bMV8Zq1qM.jpg\",\"adult\":false,\"overview\":\"After an earthquake destroys Xiang Qin's house, she and her father move in with the family of her father's college buddy. To her surprise, her new kind and amicable aunt and uncle are the parents of her cold and distant schoolmate, Jiang Zhi Shu, a genius with an IQ of 200 whom not too long ago rejected her when she confessed her feelings for him. Will the close proximity give her a second chance to win Zhi Shu's heart? Or will her love for him end under his cold words?\",\"release_date\":\"2019-02-14\"},{\"vote_count\":1655,\"id\":166428,\"video\":false,\"vote_average\":7.6,\"title\":\"How to Train Your Dragon: The Hidden World\",\"popularity\":94.97,\"poster_path\":\"\\/xvx4Yhf0DVH8G4LzNISpMfFBDy2.jpg\",\"original_language\":\"en\",\"original_title\":\"How to Train Your Dragon: The Hidden World\",\"genre_ids\":[16,10751,12],\"backdrop_path\":\"\\/lFwykSz3Ykj1Q3JXJURnGUTNf1o.jpg\",\"adult\":false,\"overview\":\"As Hiccup fulfills his dream of creating a peaceful dragon utopia, Toothless’ discovery of an untamed, elusive mate draws the Night Fury away. When danger mounts at home and Hiccup’s reign as village chief is tested, both dragon and rider must make impossible decisions to save their kind.\",\"release_date\":\"2019-01-03\"},{\"vote_count\":17497,\"id\":118340,\"video\":false,\"vote_average\":7.9,\"title\":\"Guardians of the Galaxy\",\"popularity\":92.893,\"poster_path\":\"\\/y31QB9kn3XSudA15tV7UWQ9XLuW.jpg\",\"original_language\":\"en\",\"original_title\":\"Guardians of the Galaxy\",\"genre_ids\":[28,878,12],\"backdrop_path\":\"\\/bHarw8xrmQeqf3t8HpuMY7zoK4x.jpg\",\"adult\":false,\"overview\":\"Light years from Earth, 26 years after being abducted, Peter Quill finds himself the prime target of a manhunt after discovering an orb wanted by Ronan the Accuser.\",\"release_date\":\"2014-07-30\"},{\"vote_count\":12120,\"id\":283995,\"video\":false,\"vote_average\":7.7,\"title\":\"Guardians of the Galaxy Vol. 2\",\"popularity\":88.71,\"poster_path\":\"\\/y4MBh0EjBlMuOzv9axM4qJlmhzz.jpg\",\"original_language\":\"en\",\"original_title\":\"Guardians of the Galaxy Vol. 2\",\"genre_ids\":[28,12,35,878],\"backdrop_path\":\"\\/aJn9XeesqsrSLKcHfHP4u5985hn.jpg\",\"adult\":false,\"overview\":\"The Guardians must fight to keep their newfound family together as they unravel the mysteries of Peter Quill's true parentage.\",\"release_date\":\"2017-04-19\"},{\"vote_count\":11,\"id\":543103,\"video\":false,\"vote_average\":4.9,\"title\":\"Kamen Rider Heisei Generations FOREVER\",\"popularity\":88.178,\"poster_path\":\"\\/6sOFQDlkY6El1B2P5gklzJfVdsT.jpg\",\"original_language\":\"ja\",\"original_title\":\"仮面ライダー平成ジェネレーションズFOREVER\",\"genre_ids\":[28,12,878],\"backdrop_path\":\"\\/uufTqD2CSn1NqL3cXEl4Vp3bCav.jpg\",\"adult\":false,\"overview\":\"In the world of Sougo Tokiwa and Sento Kiryu, their \\\"companions\\\" are losing their memories one after the other as they're replaced by other people. The Super Time Jacker, Tid , appears before them. He orders his powerful underlings, Another Double and Another Den-O, to pursue a young boy called Shingo. While fighting to protect Shingo, Sougo meets Ataru, a young man who loves Riders, but Ataru says that Kamen Riders aren't real. What is the meaning of those words? While the mystery deepens, the true enemy that Sougo and Sento must defeat appears in the Kuriogatake mountain...\",\"release_date\":\"2018-12-22\"},{\"vote_count\":200,\"id\":487297,\"video\":false,\"vote_average\":5.8,\"title\":\"What Men Want\",\"popularity\":87.573,\"poster_path\":\"\\/30IiwvIRqPGjUV0bxJkZfnSiCL.jpg\",\"original_language\":\"en\",\"original_title\":\"What Men Want\",\"genre_ids\":[35,14,10749],\"backdrop_path\":\"\\/wbAQKi2E5cO0Utk5KDk9yX3kuOu.jpg\",\"adult\":false,\"overview\":\"Magically able to hear what men are thinking, a sports agent uses her newfound ability to turn the tables on her overbearing male colleagues.\",\"release_date\":\"2019-02-08\"},{\"vote_count\":663,\"id\":491418,\"video\":false,\"vote_average\":7.5,\"title\":\"Instant Family\",\"popularity\":81.327,\"poster_path\":\"\\/dic3GdmMpxxfkCQfvZnasb5ZkSG.jpg\",\"original_language\":\"en\",\"original_title\":\"Instant Family\",\"genre_ids\":[35,18],\"backdrop_path\":\"\\/lwICpzZudw8BZ0bODaHgRWCdioB.jpg\",\"adult\":false,\"overview\":\"When Pete and Ellie decide to start a family, they stumble into the world of foster care adoption. They hope to take in one small child but when they meet three siblings, including a rebellious 15 year old girl, they find themselves speeding from zero to three kids overnight.\",\"release_date\":\"2018-11-16\"}]}";
    // Sample response from TMDB's API's call for the first page of top rated movies
    private final String SAMPLE_TOP_RATED_JSON_RESPONSE = "{\"page\":1,\"total_results\":7176,\"total_pages\":359,\"results\":[{\"vote_count\":2043,\"id\":19404,\"video\":false,\"vote_average\":9,\"title\":\"Dilwale Dulhania Le Jayenge\",\"popularity\":13.628,\"poster_path\":\"\\/uC6TTUhPpQCmgldGyYveKRAu8JN.jpg\",\"original_language\":\"hi\",\"original_title\":\"दिलवाले दुल्हनिया ले जायेंगे\",\"genre_ids\":[35,18,10749],\"backdrop_path\":\"\\/nl79FQ8xWZkhL3rDr1v2RFFR6J0.jpg\",\"adult\":false,\"overview\":\"Raj is a rich, carefree, happy-go-lucky second generation NRI. Simran is the daughter of Chaudhary Baldev Singh, who in spite of being an NRI is very strict about adherence to Indian values. Simran has left for India to be married to her childhood fiancé. Raj leaves for India with a mission at his hands, to claim his lady love under the noses of her whole family. Thus begins a saga.\",\"release_date\":\"1995-10-20\"},{\"vote_count\":3560,\"id\":299534,\"video\":false,\"vote_average\":8.7,\"title\":\"Avengers: Endgame\",\"popularity\":487.806,\"poster_path\":\"\\/or06FN3Dka5tukK1e9sl16pB3iy.jpg\",\"original_language\":\"en\",\"original_title\":\"Avengers: Endgame\",\"genre_ids\":[12,878,28],\"backdrop_path\":\"\\/7RyHsO4yDXtBv1zUU3mTpHeQ0d5.jpg\",\"adult\":false,\"overview\":\"After the devastating events of Avengers: Infinity War, the universe is in ruins due to the efforts of the Mad Titan, Thanos. With the help of remaining allies, the Avengers must assemble once more in order to undo Thanos' actions and restore order to the universe once and for all, no matter what consequences may be in store.\",\"release_date\":\"2019-04-24\"},{\"vote_count\":12934,\"id\":278,\"video\":false,\"vote_average\":8.7,\"title\":\"The Shawshank Redemption\",\"popularity\":27.786,\"poster_path\":\"\\/9O7gLzmreU0nGkIB6K3BsJbzvNv.jpg\",\"original_language\":\"en\",\"original_title\":\"The Shawshank Redemption\",\"genre_ids\":[18,80],\"backdrop_path\":\"\\/j9XKiZrVeViAixVRzCta7h1VU9W.jpg\",\"adult\":false,\"overview\":\"Framed in the 1940s for the double murder of his wife and her lover, upstanding banker Andy Dufresne begins a new life at the Shawshank prison, where he puts his accounting skills to work for an amoral warden. During his long stretch in prison, Dufresne comes to be admired by the other inmates -- including an older prisoner named Red -- for his integrity and unquenchable sense of hope.\",\"release_date\":\"1994-09-23\"},{\"vote_count\":9828,\"id\":238,\"video\":false,\"vote_average\":8.6,\"title\":\"The Godfather\",\"popularity\":22.75,\"poster_path\":\"\\/rPdtLWNsZmAtoZl9PK7S2wE3qiS.jpg\",\"original_language\":\"en\",\"original_title\":\"The Godfather\",\"genre_ids\":[18,80],\"backdrop_path\":\"\\/6xKCYgH16UuwEGAyroLU6p8HLIn.jpg\",\"adult\":false,\"overview\":\"Spanning the years 1945 to 1955, a chronicle of the fictional Italian-American Corleone crime family. When organized crime family patriarch, Vito Corleone barely survives an attempt on his life, his youngest son, Michael steps in to take care of the would-be killers, launching a campaign of bloody revenge.\",\"release_date\":\"1972-03-14\"},{\"vote_count\":3995,\"id\":372058,\"video\":false,\"vote_average\":8.6,\"title\":\"Your Name.\",\"popularity\":25.981,\"poster_path\":\"\\/xq1Ugd62d23K2knRUx6xxuALTZB.jpg\",\"original_language\":\"ja\",\"original_title\":\"君の名は。\",\"genre_ids\":[10749,16,18],\"backdrop_path\":\"\\/7OMAfDJikBxItZBIug0NJig5DHD.jpg\",\"adult\":false,\"overview\":\"High schoolers Mitsuha and Taki are complete strangers living separate lives. But one night, they suddenly switch places. Mitsuha wakes up in Taki’s body, and he in hers. This bizarre occurrence continues to happen randomly, and the two must adjust their lives around each other.\",\"release_date\":\"2016-08-26\"},{\"vote_count\":7844,\"id\":424,\"video\":false,\"vote_average\":8.5,\"title\":\"Schindler's List\",\"popularity\":23.134,\"poster_path\":\"\\/yPisjyLweCl1tbgwgtzBCNCBle.jpg\",\"original_language\":\"en\",\"original_title\":\"Schindler's List\",\"genre_ids\":[18,36,10752],\"backdrop_path\":\"\\/af98P1bc7lJsFjhHOVWXQgNNgSQ.jpg\",\"adult\":false,\"overview\":\"The true story of how businessman Oskar Schindler saved over a thousand Jewish lives from the Nazis while they worked as slaves in his factory during World War II.\",\"release_date\":\"1993-12-15\"},{\"vote_count\":5745,\"id\":240,\"video\":false,\"vote_average\":8.5,\"title\":\"The Godfather: Part II\",\"popularity\":19.649,\"poster_path\":\"\\/bVq65huQ8vHDd1a4Z37QtuyEvpA.jpg\",\"original_language\":\"en\",\"original_title\":\"The Godfather: Part II\",\"genre_ids\":[18,80],\"backdrop_path\":\"\\/gLbBRyS7MBrmVUNce91Hmx9vzqI.jpg\",\"adult\":false,\"overview\":\"In the continuing saga of the Corleone crime family, a young Vito Corleone grows up in Sicily and in 1910s New York. In the 1950s, Michael Corleone attempts to expand the family business into Las Vegas, Hollywood and Cuba.\",\"release_date\":\"1974-12-20\"},{\"vote_count\":7240,\"id\":129,\"video\":false,\"vote_average\":8.5,\"title\":\"Spirited Away\",\"popularity\":20.025,\"poster_path\":\"\\/oRvMaJOmapypFUcQqpgHMZA6qL9.jpg\",\"original_language\":\"ja\",\"original_title\":\"千と千尋の神隠し\",\"genre_ids\":[16,10751,14],\"backdrop_path\":\"\\/mnpRKVSXBX6jb56nabvmGKA0Wig.jpg\",\"adult\":false,\"overview\":\"A young girl, Chihiro, becomes trapped in a strange new world of spirits. When her parents undergo a mysterious transformation, she must call upon the courage she never knew she had to free her family.\",\"release_date\":\"2001-07-20\"},{\"vote_count\":7104,\"id\":637,\"video\":false,\"vote_average\":8.4,\"title\":\"Life Is Beautiful\",\"popularity\":16.159,\"poster_path\":\"\\/f7DImXDebOs148U4uPjI61iDvaK.jpg\",\"original_language\":\"it\",\"original_title\":\"La vita è bella\",\"genre_ids\":[35,18],\"backdrop_path\":\"\\/bORe0eI72D874TMawOOFvqWS6Xe.jpg\",\"adult\":false,\"overview\":\"A touching story of an Italian book seller of Jewish ancestry who lives in his own little fairy tale. His creative and happy life would come to an abrupt halt when his entire family is deported to a concentration camp during World War II. While locked up he tries to convince his son that the whole thing is just a game.\",\"release_date\":\"1997-12-20\"},{\"vote_count\":8085,\"id\":497,\"video\":false,\"vote_average\":8.4,\"title\":\"The Green Mile\",\"popularity\":23.686,\"poster_path\":\"\\/sOHqdY1RnSn6kcfAHKu28jvTebE.jpg\",\"original_language\":\"en\",\"original_title\":\"The Green Mile\",\"genre_ids\":[14,18,80],\"backdrop_path\":\"\\/Rlt20sEbOQKPVjia7lUilFm49W.jpg\",\"adult\":false,\"overview\":\"A supernatural tale set on death row in a Southern prison, where gentle giant John Coffey possesses the mysterious power to heal people's ailments. When the cell block's head guard, Paul Edgecomb, recognizes Coffey's miraculous gift, he tries desperately to help stave off the condemned man's execution.\",\"release_date\":\"1999-12-10\"},{\"vote_count\":14916,\"id\":680,\"video\":false,\"vote_average\":8.4,\"title\":\"Pulp Fiction\",\"popularity\":26.689,\"poster_path\":\"\\/dM2w364MScsjFf8pfMbaWUcWrR.jpg\",\"original_language\":\"en\",\"original_title\":\"Pulp Fiction\",\"genre_ids\":[53,80],\"backdrop_path\":\"\\/4cDFJr4HnXN5AdPw4AKrmLlMWdO.jpg\",\"adult\":false,\"overview\":\"A burger-loving hit man, his philosophical partner, a drug-addled gangster's moll and a washed-up boxer converge in this sprawling, comedic crime caper. Their adventures unfurl in three stories that ingeniously trip back and forth in time.\",\"release_date\":\"1994-09-10\"},{\"vote_count\":3548,\"id\":324857,\"video\":false,\"vote_average\":8.4,\"title\":\"Spider-Man: Into the Spider-Verse\",\"popularity\":71.86,\"poster_path\":\"\\/iiZZdoQBEYBv6id8su7ImL0oCbD.jpg\",\"original_language\":\"en\",\"original_title\":\"Spider-Man: Into the Spider-Verse\",\"genre_ids\":[28,12,16,878,35],\"backdrop_path\":\"\\/7d6EY00g1c39SGZOoCJ5Py9nNth.jpg\",\"adult\":false,\"overview\":\"Miles Morales is juggling his life between being a high school student and being a spider-man. When Wilson \\\"Kingpin\\\" Fisk uses a super collider, others from across the Spider-Verse are transported to this dimension.\",\"release_date\":\"2018-12-07\"},{\"vote_count\":417,\"id\":40096,\"video\":false,\"vote_average\":8.4,\"title\":\"A Dog's Will\",\"popularity\":7.933,\"poster_path\":\"\\/uHEmM49YphluJnGep8Ef1qwD2QX.jpg\",\"original_language\":\"pt\",\"original_title\":\"O Auto da Compadecida\",\"genre_ids\":[12,35],\"backdrop_path\":\"\\/alQqTpmEkxSLgajfEYTsTH6nAKB.jpg\",\"adult\":false,\"overview\":\"The lively João Grilo and the sly Chicó are poor guys living in the hinterland who cheat a bunch of people in a small Northeast Brazil town. But when they die, they have to be judged by Christ, the Devil and the Virgin Mary, before they are admitted to paradise.\",\"release_date\":\"2000-09-15\"},{\"vote_count\":18574,\"id\":155,\"video\":false,\"vote_average\":8.4,\"title\":\"The Dark Knight\",\"popularity\":35.191,\"poster_path\":\"\\/1hRoyzDtpgMU7Dz4JF22RANzQO7.jpg\",\"original_language\":\"en\",\"original_title\":\"The Dark Knight\",\"genre_ids\":[18,28,80,53],\"backdrop_path\":\"\\/hqkIcbrOHL86UncnHIsHVcVmzue.jpg\",\"adult\":false,\"overview\":\"Batman raises the stakes in his war on crime. With the help of Lt. Jim Gordon and District Attorney Harvey Dent, Batman sets out to dismantle the remaining criminal organizations that plague the streets. The partnership proves to be effective, but they soon find themselves prey to a reign of chaos unleashed by a rising criminal mastermind known to the terrified citizens of Gotham as the Joker.\",\"release_date\":\"2008-07-16\"},{\"vote_count\":16005,\"id\":550,\"video\":false,\"vote_average\":8.4,\"title\":\"Fight Club\",\"popularity\":29.121,\"poster_path\":\"\\/adw6Lq9FiC9zjYEpOqfq03ituwp.jpg\",\"original_language\":\"en\",\"original_title\":\"Fight Club\",\"genre_ids\":[18],\"backdrop_path\":\"\\/mMZRKb3NVo5ZeSPEIaNW9buLWQ0.jpg\",\"adult\":false,\"overview\":\"A ticking-time-bomb insomniac and a slippery soap salesman channel primal male aggression into a shocking new form of therapy. Their concept catches on, with underground \\\"fight clubs\\\" forming in every town, until an eccentric gets in the way and ignites an out-of-control spiral toward oblivion.\",\"release_date\":\"1999-10-15\"},{\"vote_count\":14472,\"id\":13,\"video\":false,\"vote_average\":8.4,\"title\":\"Forrest Gump\",\"popularity\":24.668,\"poster_path\":\"\\/yE5d3BUhE8hCnkMUJOo1QDoOGNz.jpg\",\"original_language\":\"en\",\"original_title\":\"Forrest Gump\",\"genre_ids\":[35,18,10749],\"backdrop_path\":\"\\/wMgbnUVS9wbRGAdki8fqxKU1O0N.jpg\",\"adult\":false,\"overview\":\"A man with a low IQ has accomplished great things in his life and been present during significant historic events—in each case, far exceeding what anyone imagined he could do. But despite all he has achieved, his one true love eludes him.\",\"release_date\":\"1994-07-06\"},{\"vote_count\":4804,\"id\":539,\"video\":false,\"vote_average\":8.4,\"title\":\"Psycho\",\"popularity\":20.643,\"poster_path\":\"\\/81d8oyEFgj7FlxJqSDXWr8JH8kV.jpg\",\"original_language\":\"en\",\"original_title\":\"Psycho\",\"genre_ids\":[27,18],\"backdrop_path\":\"\\/3md49VBCeqY6MSNyAVY6d5eC6bA.jpg\",\"adult\":false,\"overview\":\"When larcenous real estate clerk Marion Crane goes on the lam with a wad of cash and hopes of starting a new life, she ends up at the notorious Bates Motel, where manager Norman Bates cares for his housebound mother. The place seems quirky, but fine… until Marion decides to take a shower.\",\"release_date\":\"1960-06-16\"},{\"vote_count\":12918,\"id\":122,\"video\":false,\"vote_average\":8.4,\"title\":\"The Lord of the Rings: The Return of the King\",\"popularity\":36.476,\"poster_path\":\"\\/rCzpDGLbOoPwLjy3OAm5NUPOTrC.jpg\",\"original_language\":\"en\",\"original_title\":\"The Lord of the Rings: The Return of the King\",\"genre_ids\":[12,14,28],\"backdrop_path\":\"\\/8BPZO0Bf8TeAy8znF43z8soK3ys.jpg\",\"adult\":false,\"overview\":\"Aragorn is revealed as the heir to the ancient kings as he, Gandalf and the other members of the broken fellowship struggle to save Gondor from Sauron's forces. Meanwhile, Frodo and Sam bring the ring closer to the heart of Mordor, the dark lord's realm.\",\"release_date\":\"2003-12-01\"},{\"vote_count\":271,\"id\":484468,\"video\":false,\"vote_average\":8.4,\"title\":\"The Wolf's Call\",\"popularity\":5.379,\"poster_path\":\"\\/hy2rqt5TezQUnca8k1HZalQzqHs.jpg\",\"original_language\":\"fr\",\"original_title\":\"Le chant du loup\",\"genre_ids\":[53,18],\"backdrop_path\":\"\\/vadfaj3hqzgDFTSdWUMp5onELPK.jpg\",\"adult\":false,\"overview\":\"Thriller set in the milieu of French nuclear submarines.\",\"release_date\":\"2019-02-20\"},{\"vote_count\":3648,\"id\":389,\"video\":false,\"vote_average\":8.4,\"title\":\"12 Angry Men\",\"popularity\":16.327,\"poster_path\":\"\\/3W0v956XxSG5xgm7LB6qu8ExYJ2.jpg\",\"original_language\":\"en\",\"original_title\":\"12 Angry Men\",\"genre_ids\":[18],\"backdrop_path\":\"\\/lH2Ga8OzjU1XlxJ73shOlPx6cRw.jpg\",\"adult\":false,\"overview\":\"The defense and the prosecution have rested and the jury is filing into the jury room to decide if a young Spanish-American is guilty or innocent of murdering his father. What begins as an open and shut case soon becomes a mini-drama of each of the jurors' prejudices and preconceptions about the trial, the accused, and each other.\",\"release_date\":\"1957-03-25\"}]}";
    // Number of movies listed in each JSON page
    private final int JSON_RESPONSE_PAGE_SIZE = 20;
    private MovieJSONResult mostPopularJsonResult, topRatedJsonResult;
    private List<Movie> mostPopularMovieList, topRatedMovieList;
    private Gson gson;

    @Before
    public void setup() {
        gson = new Gson();
        mostPopularJsonResult = gson.fromJson(SAMPLE_MOST_POPULAR_JSON_RESPONSE, MovieJSONResult.class);
        topRatedJsonResult = gson.fromJson(SAMPLE_TOP_RATED_JSON_RESPONSE, MovieJSONResult.class);
        mostPopularMovieList = mostPopularJsonResult.getResults();
        topRatedMovieList = topRatedJsonResult.getResults();
    }

    @After
    public void cleanup() {
        gson = null;
        mostPopularJsonResult = null;
        topRatedJsonResult = null;
        mostPopularMovieList = null;
        topRatedMovieList = null;
    }

    @Test
    public void checkGson() {
        assertThat(gson, notNullValue());
    }

    @Test
    public void checkPopularMovieJsonResult() {
        assertThat(mostPopularJsonResult, notNullValue());
    }

    @Test
    public void checkTopRatedMovieJsonResult() {
        assertThat(topRatedJsonResult, notNullValue());
    }

    @Test
    public void checkPopularMovieList() {
        assertMovieList(mostPopularMovieList);
    }

    @Test
    public void checkTopRatedMovieList() {
        assertMovieList(topRatedMovieList);
    }

    @Test
    public void checkFirstMovieFromPopularMovieList() {
        Movie movie = mostPopularMovieList.get(0);
        assertThat(movie, notNullValue());
        assertThat(movie.getId(), is(299534L));
        assertThat(movie.getUserRating(), is(8.7));
        assertThat(movie.getTitle(), is("Avengers: Endgame"));
        assertThat(movie.getOriginalTitle(), is("Avengers: Endgame"));
        assertThat(movie.getReleaseDate(), is("2019-04-24"));
        assertThat(movie.getPosterPath(), is("/or06FN3Dka5tukK1e9sl16pB3iy.jpg"));
        assertThat(movie.getBackdropPosterPath(), is("/7RyHsO4yDXtBv1zUU3mTpHeQ0d5.jpg"));
        assertThat(movie.getGenreIds().get(0), is(12));
        assertThat(movie.getGenreIds().get(1), is(878));
        assertThat(movie.getGenreIds().get(2), is(28));
        assertThat(movie.getOverview(), is("After the devastating events of Avengers: Infinity War, the universe is in ruins due to the efforts of the Mad Titan, Thanos. With the help of remaining allies, the Avengers must assemble once more in order to undo Thanos' actions and restore order to the universe once and for all, no matter what consequences may be in store."));
    }

    @Test
    public void checkFirstMovieFromTopRatedMovieList() {
        Movie movie = topRatedMovieList.get(0);
        assertThat(movie, notNullValue());
        assertThat(movie.getId(), is(19404L));
        assertThat(movie.getUserRating(), is(9.0));
        assertThat(movie.getTitle(), is("Dilwale Dulhania Le Jayenge"));
        assertThat(movie.getOriginalTitle(), is("दिलवाले दुल्हनिया ले जायेंगे"));
        assertThat(movie.getReleaseDate(), is("1995-10-20"));
        assertThat(movie.getPosterPath(), is("/uC6TTUhPpQCmgldGyYveKRAu8JN.jpg"));
        assertThat(movie.getBackdropPosterPath(), is("/nl79FQ8xWZkhL3rDr1v2RFFR6J0.jpg"));
        assertThat(movie.getGenreIds().get(0), is(35));
        assertThat(movie.getGenreIds().get(1), is(18));
        assertThat(movie.getGenreIds().get(2), is(10749));
        assertThat(movie.getOverview(), is("Raj is a rich, carefree, happy-go-lucky second generation NRI. Simran is the daughter of Chaudhary Baldev Singh, who in spite of being an NRI is very strict about adherence to Indian values. Simran has left for India to be married to her childhood fiancé. Raj leaves for India with a mission at his hands, to claim his lady love under the noses of her whole family. Thus begins a saga."));
    }

    private void assertMovieList(@NonNull final List<Movie> movieList) {
        assertThat(movieList, notNullValue());
        assertThat(movieList.size(), is(JSON_RESPONSE_PAGE_SIZE));
    }

}
